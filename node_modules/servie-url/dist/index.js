"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const url_1 = require("url");
const map = new WeakMap();
/**
 * Parse pathname from request url.
 */
function toURL(url) {
    return new url_1.URL(url, "http://localhost");
}
/**
 * Parse pathname from request instance.
 */
function getURL(req) {
    const { url } = req;
    const cache = map.get(req);
    if (!cache) {
        const URL = toURL(url);
        map.set(req, { url, URL });
        return URL;
    }
    if (cache.url === req.url)
        return cache.URL;
    const URL = toURL(url);
    map.set(req, { URL, url });
    return URL;
}
exports.getURL = getURL;
//# sourceMappingURL=index.js.map